<script>
var app = new Vue({
  el: '#app',
  delimiters: ['${', '}'],
  data: {
    newTask: '',
    tasks: []
  },
  methods: {
    loadTasks: function(){
      axios.get('/tasks')
      .then((result) => {
        this.tasks = result.data.tasks;
      });
    },

    addTask: function(){
      if(this.newTask == '')
        return;

      axios.post('/tasks', { title: this.newTask })
      .then(() => {
        this.newTask = '';
        this.loadTasks();
      });
    },

    switchTask: function(task){
      axios.put(`/task/${task._id}`, {
        newTaskData:{
          isDone: !task.isDone
        }
      })
      .then(() => {
        task.isDone = !task.isDone;
      });
    },

    removeTask: function(task, taskIndex){
      axios.delete(`/task/${task._id}`)
      .then(() => {
        this.tasks.splice(taskIndex, 1);
      });
    }
  },
   beforeMount(){
      this.loadTasks()
   },
});
</script>
